import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as i,b as e,d as t,o as l}from"./app-CpiO4BJd.js";const p={};function h(r,s){return l(),n("div",null,[s[0]||(s[0]=i("h1",{id:"点击劫持",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#点击劫持"},[i("span",null,"点击劫持")])],-1)),s[1]||(s[1]=i("blockquote",null,[i("p",null,"在网页覆盖一个透明iframe页面，诱使用户点击")],-1)),e(" more "),s[2]||(s[2]=t(`<h2 id="攻击方式" tabindex="-1"><a class="header-anchor" href="#攻击方式"><span>攻击方式</span></a></h2><h3 id="隐藏页面" tabindex="-1"><a class="header-anchor" href="#隐藏页面"><span>隐藏页面</span></a></h3><div class="language-html line-numbers-mode" data-highlighter="shiki" data-ext="html" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">style</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">			iframe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				position: </span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">absolute</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">    			top</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">-800</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">px</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        		width: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">400</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">px</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        		height: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">400</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">px</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        		z-index: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">999</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        		opacity: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">style</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iframe</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> src</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://...&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iframe</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">body</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">html</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>position使用绝对路径z-index才会生效，z-index控制覆盖顺序因此足够大才保证覆盖页面，opacity调整透明度</p><h3 id="图片覆盖攻击" tabindex="-1"><a class="header-anchor" href="#图片覆盖攻击"><span>图片覆盖攻击</span></a></h3><p>调整图片style属性，将图片覆盖在指定位置，伪造成一个正常网站，或者覆盖正确内容</p><h3 id="拖拽劫持" tabindex="-1"><a class="header-anchor" href="#拖拽劫持"><span>拖拽劫持</span></a></h3><p>诱使用户在不可见“iframe”页面拖拽出所需数据到另一可控页面</p><p>现代浏览器为防御规定无法从跨域iframe页面拖拽出数据，但可在不同窗口间拖拽</p><h3 id="文件劫持" tabindex="-1"><a class="header-anchor" href="#文件劫持"><span>文件劫持</span></a></h3><p>上传文件伪造成下载文件位置，诱使用户将整个文件夹上传，目前浏览器进行该操作会提示是否上传</p><h2 id="防御" tabindex="-1"><a class="header-anchor" href="#防御"><span>防御</span></a></h2><h3 id="frame-busting" tabindex="-1"><a class="header-anchor" href="#frame-busting"><span>Frame Busting</span></a></h3><p>写一段javascript代码禁止iframe嵌套</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>if ( top.location != location ){</span></span>
<span class="line"><span>	top.location = self.location;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>常见检测方法：</p><ol><li>if (top != self)</li><li>if (top.location != self.location)</li><li>if (top.location != location)</li><li>if (parent.frames.length &gt; 0)</li><li>if (window != top)</li><li>if (window.top !== window.self)</li><li>if (parent &amp;&amp; parent != parent.window)</li><li>if (parent &amp;&amp; parent.frames &amp;&amp; parent.frames.length&gt;0)</li><li>if ((self,parent &amp;&amp; !(self.parent === self)) &amp;&amp; (self,parent.frames.length != 0))</li></ol><p>漏洞：由于使用javascript编写存在绕过风险，且可通过设置iframe的sandbox属性使其失效</p><h3 id="cookie-samesite" tabindex="-1"><a class="header-anchor" href="#cookie-samesite"><span>Cookie：SameSite</span></a></h3><p>iframe页面属于未登录状态无法实施攻击</p><h3 id="x-frame-options" tabindex="-1"><a class="header-anchor" href="#x-frame-options"><span>X-Frame-Options</span></a></h3><ol><li>DENY：拒绝当前页面通过frame加载</li><li>SAMEORIGIN：只能被同源页面加载</li><li>ALLOW-FROM=url：定义哪些URL可通过frame加载该页面</li></ol><h3 id="csp-frame-ancestors" tabindex="-1"><a class="header-anchor" href="#csp-frame-ancestors"><span>CSP：frame-ancestors</span></a></h3><p>设置frame-ancestors属性构建白名单</p>`,24))])}const o=a(p,[["render",h]]),c=JSON.parse('{"path":"/posts/learning/%E7%82%B9%E5%87%BB%E5%8A%AB%E6%8C%81.html","title":"点击劫持","lang":"zh-CN","frontmatter":{"icon":"book-open-reader","date":"2024-09-01T00:00:00.000Z","description":"在网页覆盖一个透明iframe页面，诱使用户点击","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"点击劫持\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-09-01T00:00:00.000Z\\",\\"dateModified\\":\\"2025-04-27T11:16:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"云烟驻\\",\\"url\\":\\"https://yunyin.pages.dev\\"}]}"],["meta",{"property":"og:url","content":"https://gitee.com/shadow-of-cloud/my-docs/posts/learning/%E7%82%B9%E5%87%BB%E5%8A%AB%E6%8C%81.html"}],["meta",{"property":"og:site_name","content":"博客主页"}],["meta",{"property":"og:title","content":"点击劫持"}],["meta",{"property":"og:description","content":"在网页覆盖一个透明iframe页面，诱使用户点击"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-04-27T11:16:37.000Z"}],["meta",{"property":"article:published_time","content":"2024-09-01T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-04-27T11:16:37.000Z"}]]},"git":{"createdTime":1745752597000,"updatedTime":1745752597000,"contributors":[{"name":"云影","username":"","email":"14521425+shadow-of-cloud@user.noreply.gitee.com","commits":1}]},"readingTime":{"minutes":1.44,"words":431},"filePathRelative":"posts/learning/点击劫持.md","excerpt":"\\n<blockquote>\\n<p>在网页覆盖一个透明iframe页面，诱使用户点击</p>\\n</blockquote>\\n","autoDesc":true}');export{o as comp,c as data};
